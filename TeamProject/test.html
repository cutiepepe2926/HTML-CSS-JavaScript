<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>동네 맛집 지도</title>

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700&family=Material+Symbols+Rounded:FILL,opsz,wght,GRAD@0,24,600,0" rel="stylesheet" />

<!-- Leaflet -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<style>
  :root{
    --bg:#fafafa; --card:#fff; --text:#1f2937; --muted:#6b7280;
    --primary:#7c3aed; --ring:#e9d5ff; --line:#e5e7eb;
    --chip:#f3f4f6; --chip-on:#111827; --chip-on-bg:#e5e7eb;
    --danger:#ef4444;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family: Pretendard,system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
    background:var(--bg); color:var(--text);
  }

  /* ======= Layout ======= */
  .app{
    display:grid;
    grid-template-columns: 72px 480px 1fr;
    grid-template-rows: 100dvh;
  }
  @media (max-width:1200px){
    .app{ grid-template-columns: 64px 420px 1fr; }
  }
  @media (max-width:960px){
    .app{ grid-template-columns: 64px 1fr; grid-template-rows: auto auto }
    .panel{ order:2 }
    .map-wrap{ order:3; height:55vh }
  }
  @media (max-width:520px){
    .map-wrap{ height:50vh }
  }

  /* ======= Sidebar ======= */
  .sidebar{
    border-right:1px solid var(--line);
    background:#fff; display:flex; flex-direction:column; align-items:center; gap:12px; padding:12px 8px;
  }
  .side-logo{ width:40px; height:40px; border-radius:12px; background:var(--primary); box-shadow: 0 10px 20px rgba(124,58,237,.3); }
  .side-item{
    width:44px; height:44px; border-radius:12px; display:grid; place-items:center;
    color:#111827; cursor:pointer; transition:.2s; position:relative;
  }
  .side-item:hover{ background:#f9fafb }
  .side-item.active{ background:#111827; color:#fff }
  .side-item .material-symbols-rounded{ font-size:22px }

  /* ======= Panel ======= */
  .panel{
    padding:24px; overflow:auto;
  }
  .header{
    display:flex; align-items:center; gap:12px; margin-bottom:16px;
  }
  .loc{
    font-weight:700; font-size:20px;
  }
  .search{
    margin-left:auto; display:flex; align-items:center; gap:8px; background:#fff; border:1px solid var(--line); border-radius:12px; padding:8px 12px;
  }
  .search input{ border:0; outline:0; font-size:14px; width:160px; }
  .card{
    background:var(--card); border:1px solid var(--line); border-radius:20px; overflow:hidden;
    box-shadow: 0 8px 24px rgba(0,0,0,.04);
  }
  .hero{ width:100%; aspect-ratio: 4/3; object-fit:cover; display:block }
  .content{ padding:18px 20px }
  .title-row{ display:flex; align-items:baseline; gap:10px }
  .name{ font-weight:700; font-size:22px }
  .cat{ color:var(--muted); font-size:14px }
  .stars{ margin-left:auto; color:#f59e0b; letter-spacing:2px }
  .heart{
    margin-left:10px; border:1px solid var(--line); width:36px; height:36px; border-radius:12px; display:grid; place-items:center; cursor:pointer; transition:.15s;
  }
  .heart[data-on="true"]{ border-color:#fecaca; background:#fff1f2; color:#e11d48 }
  .meta{ display:grid; grid-template-columns:1fr; gap:6px; margin-top:12px; color:#374151; font-size:14px }
  .meta .row{ display:flex; align-items:center; gap:8px }
  .bullet{ display:inline-flex; align-items:center; gap:8px; color:#111827; font-size:14px; margin-top:14px }
  .bullet .dot{ color:#ef4444 }
  .gallery{
    border-top:1px solid var(--line); padding:14px 16px; display:flex; gap:10px; overflow:auto;
  }
  .thumb{ width:90px; height:90px; border-radius:14px; object-fit:cover; flex:0 0 auto; border:1px solid var(--line) }

  /* ======= Filter Chips ======= */
  .filters{
    display:flex; gap:10px; flex-wrap:wrap; padding:14px 16px; border-top:1px solid var(--line); background:#fbfbfb
  }
  .chip{
    display:inline-flex; align-items:center; gap:6px; padding:8px 12px; border-radius:999px; background:var(--chip);
    border:1px solid var(--line); cursor:pointer; font-weight:600; font-size:14px;
  }
  .chip[data-on="true"]{ background:var(--chip-on-bg); color:var(--chip-on) }

  /* ======= Map ======= */
  .map-wrap{ position:relative }
  #map{ width:100%; height:100% }
  .pin{
    width:22px; height:22px; border-radius:50% 50% 50% 0; transform:rotate(-45deg);
    border:2px solid #fff; box-shadow:0 2px 8px rgba(0,0,0,.25)
  }
  .pin.pink{ background:#d946ef }
  .pin.black{ background:#111827 }
  .pin.gray{ background:#9ca3af }
  .fav-btn{
    position:absolute; right:18px; top:18px; background:#fff; border:1px solid var(--line);
    padding:10px 14px; border-radius:999px; display:flex; align-items:center; gap:8px; cursor:pointer;
    box-shadow: 0 10px 20px rgba(0,0,0,.06)
  }
  .fav-btn .dot{ color:#ef4444 }
  .map-legend{
    position:absolute; left:50%; transform:translateX(-50%); bottom:14px;
    display:flex; gap:10px; flex-wrap:wrap; padding:8px 10px; background:rgba(255,255,255,.9); border:1px solid var(--line); border-radius:14px;
  }
  .legend-item{ display:flex; align-items:center; gap:6px; font-size:13px }
  .legend-dot{ width:12px; height:12px; border-radius:50% }
  .ld-pink{ background:#d946ef } .ld-black{ background:#111827 } .ld-gray{ background:#9ca3af }
</style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="side-logo"></div>
      <div class="side-item active" title="지도"><span class="material-symbols-rounded">map</span></div>
      <div class="side-item" title="검색"><span class="material-symbols-rounded">search</span></div>
      <div class="side-item" title="알림"><span class="material-symbols-rounded">notifications</span></div>
      <div class="side-item" title="왕관"><span class="material-symbols-rounded">workspace_premium</span></div>
      <div style="margin-top:auto"></div>
      <div class="side-item" title="설정"><span class="material-symbols-rounded">settings</span></div>
    </aside>

    <!-- Left Panel -->
    <main class="panel">
      <div class="header">
        <div class="loc">강남구 역삼1동</div>
        <label class="search" for="q">
          <span class="material-symbols-rounded" aria-hidden="true">search</span>
          <input id="q" type="search" placeholder="가게, 메뉴 검색" />
        </label>
      </div>

      <article class="card" id="detail">
        <img class="hero" src="https://images.unsplash.com/photo-1553621042-f6e147245754?q=80&w=1600&auto=format&fit=crop" alt="대표 음식 이미지" />
        <div class="content">
          <div style="display:flex; align-items:center">
            <div class="title-row">
              <div class="name" id="shopName">오오기리</div>
              <div class="cat" id="shopCat">일식</div>
              <div class="stars" aria-label="평점">★★★★★</div>
            </div>
            <button id="heartBtn" class="heart" aria-pressed="false" title="즐겨찾기">
              <span class="material-symbols-rounded" aria-hidden="true">favorite</span>
            </button>
          </div>

          <div class="meta">
            <div class="row"><span class="material-symbols-rounded" aria-hidden="true">call</span> <span id="tel">02-1234-5678</span></div>
            <div class="row"><span class="material-symbols-rounded" aria-hidden="true">schedule</span> <span id="hour">09:00 ~ 18:00</span></div>
          </div>

          <div class="bullet"><span class="dot">❤</span> 내 팔로워 2명이 좋아요를 눌렀습니다.</div>
          <div class="bullet"><span class="dot">●</span> xxx님이 리뷰를 작성한 식당입니다.</div>
        </div>

        <div class="gallery" id="gallery">
          <img class="thumb" src="https://images.unsplash.com/photo-1526312426976-593c2b999c59?q=80&w=600" alt="" />
          <img class="thumb" src="https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=600" alt="" />
          <img class="thumb" src="https://images.unsplash.com/photo-1589308078059-be1415eab4c3?q=80&w=600" alt="" />
          <img class="thumb" src="https://images.unsplash.com/photo-1544025162-d76694265947?q=80&w=600" alt="" />
          <img class="thumb" src="https://images.unsplash.com/photo-1526312426976-593c2b999c59?q=80&w=600" alt="" />
        </div>

        <div class="filters" id="filters">
          <!-- chips are injected by JS -->
        </div>
      </article>
    </main>

    <!-- Map -->
    <section class="map-wrap">
      <div id="map" role="region" aria-label="지도"></div>
      <button class="fav-btn" id="favOnlyBtn">
        <span class="dot">❤</span> 팔로잉
      </button>
      <div class="map-legend">
        <div class="legend-item"><span class="legend-dot ld-pink"></span> 팔로잉 가게</div>
        <div class="legend-item"><span class="legend-dot ld-black"></span> 일반 가게</div>
        <div class="legend-item"><span class="legend-dot ld-gray"></span> 비활성(필터 제외)</div>
      </div>
    </section>
  </div>

<script>
/* ======== Sample Data ======== */
const CATS = ["한식","중식","일식","양식","분식"];
const PLACES = [
  { id:1, name:"오오기리", cat:"일식", tel:"02-1234-5678", hour:"09:00 ~ 18:00", lat:37.4999, lng:127.0374, following:true },
  { id:2, name:"명동칼국수", cat:"한식", tel:"02-8888-2222", hour:"11:00 ~ 21:00", lat:37.5008, lng:127.0335, following:false },
  { id:3, name:"훠궈하우스", cat:"중식", tel:"02-6666-7777", hour:"10:30 ~ 22:00", lat:37.4969, lng:127.0321, following:true },
  { id:4, name:"브런치랩", cat:"양식", tel:"02-9988-1122", hour:"09:00 ~ 17:30", lat:37.5015, lng:127.0437, following:false },
  { id:5, name:"떡볶이연구소", cat:"분식", tel:"02-5555-3131", hour:"12:00 ~ 20:00", lat:37.4958, lng:127.0408, following:false },
];

/* ======== UI Elements ======== */
const heartBtn = document.getElementById('heartBtn');
const favOnlyBtn = document.getElementById('favOnlyBtn');
const filtersWrap = document.getElementById('filters');
const q = document.getElementById('q');

let activeCats = new Set(CATS); // all on by default
let showFavOnly = false;

/* ======== Build Chips ======== */
CATS.forEach(cat=>{
  const chip = document.createElement('button');
  chip.className = 'chip';
  chip.dataset.on = "true";
  chip.innerHTML = iconFor(cat) + cat;
  chip.addEventListener('click', ()=>{
    if (activeCats.has(cat)) { activeCats.delete(cat); chip.dataset.on = "false" }
    else { activeCats.add(cat); chip.dataset.on = "true" }
    renderMarkers();
  });
  filtersWrap.appendChild(chip);
});
function iconFor(cat){
  const map = {
    "한식":"<span class='material-symbols-rounded' aria-hidden='true'>rice_bowl</span>",
    "중식":"<span class='material-symbols-rounded' aria-hidden='true'>restaurant</span>",
    "일식":"<span class='material-symbols-rounded' aria-hidden='true'>ramen_dining</span>",
    "양식":"<span class='material-symbols-rounded' aria-hidden='true'>lunch_dining</span>",
    "분식":"<span class='material-symbols-rounded' aria-hidden='true'>fastfood</span>",
  };
  return map[cat] || "";
}

/* ======== Favorite Toggle (detail card) ======== */
heartBtn.addEventListener('click', ()=>{
  const on = heartBtn.getAttribute('data-on') === 'true';
  heartBtn.setAttribute('data-on', String(!on));
});

/* ======== Map ======== */
const map = L.map('map',{ zoomControl:false }).setView([37.498,127.037], 15);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{ maxZoom:19, attribution:'© OpenStreetMap' }).addTo(map);
L.control.zoom({ position:"bottomright" }).addTo(map);

const markerLayer = L.layerGroup().addTo(map);

function markerIcon(kind){
  const div = document.createElement('div');
  div.className = 'pin ' + (kind==='fav' ? 'pink' : kind==='off' ? 'gray' : 'black');
  return L.divIcon({ className:'', html:div, iconSize:[22,22], iconAnchor:[11,22], popupAnchor:[0,-12] });
}

/* ======== Render Markers ======== */
function renderMarkers(){
  markerLayer.clearLayers();
  const keyword = q.value?.trim();
  PLACES.forEach(p=>{
    const catOn = activeCats.has(p.cat);
    const matchText = !keyword || p.name.includes(keyword);
    const isVisible = catOn && matchText && (!showFavOnly || p.following);

    const state = !catOn || !matchText ? 'off' : (p.following ? 'fav' : 'norm');
    const icon = markerIcon(state);

    const m = L.marker([p.lat,p.lng], { icon, opacity: isVisible?1:0.5, interactive: isVisible });
    m.bindPopup(`
      <strong>${p.name}</strong><br/>
      <small>${p.cat}</small><br/>
      <span class="material-symbols-rounded" style="font-size:14px;vertical-align:-3px">call</span> ${p.tel}<br/>
      <span class="material-symbols-rounded" style="font-size:14px;vertical-align:-3px">schedule</span> ${p.hour}
    `);
    m.on('click', ()=>fillDetail(p));
    markerLayer.addLayer(m);
  });
}
renderMarkers();

/* ======== Detail Fill ======== */
function fillDetail(p){
  document.getElementById('shopName').textContent = p.name;
  document.getElementById('shopCat').textContent = p.cat;
  document.getElementById('tel').textContent = p.tel;
  document.getElementById('hour').textContent = p.hour;
}

/* ======== Search & FavOnly ======== */
q.addEventListener('input', ()=>renderMarkers());
favOnlyBtn.addEventListener('click', ()=>{
  showFavOnly = !showFavOnly;
  favOnlyBtn.style.borderColor = showFavOnly ? '#fecaca' : 'var(--line)';
  favOnlyBtn.style.background = showFavOnly ? '#fff1f2' : '#fff';
  renderMarkers();
});

/* Focus to the first place on load */
fillDetail(PLACES[0]);
</script>
</body>
</html>
